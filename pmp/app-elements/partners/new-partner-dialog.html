<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/etools-dialog/etools-dialog.html">

<dom-module id="new-partner-dialog">
  <template>
    <style>
      #vendorNo {
        margin-bottom: 30px;
      }
    </style>
    <etools-dialog id="newPartnerDialog" size="lg" ok-btn-text="Save" disable-confirm-btn="[[vendorNumberIsEmpty]]"
                   dialog-title="New Partner" on-close="_handleDialogClosed">
      <paper-input id="vendorNo" label="Vendor #" value="{{vendor_number}}"
                   placeholder="&#8212;" autofocus
                   required auto-validate error-message="Vendor# is required"
                   allowed-pattern="[0-9]"
                   char-counter
                   maxlength="11"></paper-input>
    </etools-dialog>
  </template>
</dom-module>

<script>
  (function() {
    'use strict';
    Polymer({
      is: 'new-partner-dialog',
      properties: {
        vendor_number: {
          type: String
        },
        vendorNumberIsEmpty: {
          type: Boolean,
          computed: '_vendorNumberIsEmpty(vendor_number)'
        }
      },
      _openNewPartnerDialog: function() {
        this.$.vendorNo.invalid = false;
        this.$.newPartnerDialog.opened = true;
      },
      _vendorNumberIsEmpty: function() {
        return !!!this.vendor_number;
      },
      _handleDialogClosed: function(closingReason) {
        if (closingReason.detail.confirmed) {
          if (!this.vendor_number) {
            return;
          }
          this.fire('create-partner', {vendor: this.vendor_number});
        } else {
          this.vendor_number = '';
        }
      }
    });
  })();
</script>

<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/etools-checkable-input/etools-checkable-input.html">

<link rel="import" href="../../app-behaviors/repeatable-data-sets-behavior.html">

<link rel="import" href="../../../styles/app-mixins.html">
<link rel="import" href="../../../styles/grid-layout-styles.html">
<link rel="import" href="../../../styles/shared-styles.html">
<link rel="import" href="../../../styles/repeatable-data-sets-styles.html">

<dom-module id="staff-members">
  <template>
    <style include="grid-layout-styles shared-styles repeatable-data-sets-styles">
      [hidden] {
        display: none !important;
      }

      :host {
        display: block;
        width: 100%;
        padding-bottom: 30px;

        --paper-fab-keyboard-focus-background: #8dc63f; /* TODO: replace with app-theme var */
        --paper-fab: {
          @apply(--paper-fab-btn-green);
        };

        --etools-checkable-input-font-size: 16px;
        --etools-checkable-input-label: {
          color: var(--dark-primary-text-color);
          @apply(--layout-vertical);
          @apply(--layout-center-justified);
        };
        --etools-checkable-input-size: 16px;
      }

      paper-icon-button[disabled] {
        visibility: hidden;
      }

      .active-box {
        box-sizing: border-box;
        min-height: 60px;
        padding-bottom: 10px;
        @apply(--layout-vertical);
        @apply(--layout-end-justified);
      }

    </style>

    <div hidden$="[[_emptyList(dataItems.length)]]">
      <template is="dom-repeat" items="{{dataItems}}">
        <div class="row-h item-container">
          <div class="row-h item-actions-container">
            <div class="row-v actions">
              <paper-icon-button class="action delete"
                                 on-tap="_openDeleteConfirmation"
                                 data-args$="[[index]]"
                                 disabled="[[!_canBeRemoved(index)]]"
                                 icon="cancel"></paper-icon-button>
            </div>
          </div>
          <div class="row-v flex-c item-content">
            <div class="row-h">
              <div class="col col-4">
                <!-- Position -->
                <paper-input label="Position"
                             value="{{item.position}}"
                             placeholder="&#8212;"
                             readonly$="[[!editMode]]">
                </paper-input>
              </div>
              <div class="col col-4">
                <!-- First Name -->
                <paper-input label="First Name"
                             value="{{item.first_name}}"
                             placeholder="&#8212;"
                             readonly$="[[!editMode]]">
                </paper-input>
              </div>
              <div class="col col-4">
                <!-- Last Name -->
                <paper-input label="Last Name"
                             value="{{item.last_name}}"
                             placeholder="&#8212;"
                             readonly$="[[!editMode]]">
                </paper-input>
              </div>
            </div>
            <div class="row-h">
              <div class="col col-4">
                <!-- Phone number -->
                <paper-input label="Phone number"
                             value="{{item.phone_number}}"
                             placeholder="&#8212;"
                             readonly$="[[!editMode]]">
                  <iron-icon prefix icon="communication:phone"></iron-icon>
                </paper-input>
              </div>
              <div class="col col-4">
                <!-- Email address -->
                <paper-input label="E-mail address"
                             value="{{item.email_address}}"
                             placeholder="&#8212;"
                             readonly$="[[!_canBeRemoved(index)]]">
                  <iron-icon prefix icon="communication:email"></iron-icon>
                </paper-input>
              </div>
              <div class="col col-4">
                <!-- Active? -->
                <div class="active-box">
                  <etools-checkable-input checked="{{item.active}}"
                                          label="Active?"
                                          type="checkbox"
                                          label-alignment="right"
                                          readonly$="[[!editMode]]">
                  </etools-checkable-input>
                </div>
              </div>
            </div>

          </div>
        </div>
      </template>
    </div>

    <div class="row-h" hidden$="[[!_emptyList(dataItems.length)]]">
      <p>There are no assessments added.</p>
    </div>

    <div id="bottom-actions" class="row-h" hidden$="[[!editMode]]">
      <paper-fab icon="add"
                 on-tap="_addElement"
                 title="Add"></paper-fab>
    </div>

  </template>

  <script>
    Polymer({
      is: 'staff-members',
      behaviors: [
        etoolsBehaviors.DynamicDialogBehavior,
        etoolsPmpBehaviors.RepeatableDataSetsBehavior
      ],
      properties: {

      },

      ready: function() {
        this.dataSetModel = {
          id: null,
          position: null,
          first_name: null,
          last_name: null,
          phone_number: null,
          email_address: null,
          active: false
        };
      },

      _canBeRemoved: function(index) {
        if (!this.editMode) {
          return false;
        }
        if (this.dataItems[index] && typeof this.dataItems[index].id !== 'undefined' && this.dataItems[index].id !== null) {
          return false;
        }
        return true;
      }

    });
  </script>
</dom-module>

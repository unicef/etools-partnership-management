<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="../../app-behaviors/common-general-behavior.html">
<link rel="import" href="../../app-behaviors/risk-rating-behavior.html">

<link rel="import" href="../../../styles/app-mixins.html">
<link rel="import" href="../../../styles/page-layout-styles.html">
<link rel="import" href="../../../styles/grid-layout-styles.html">
<link rel="import" href="../../../styles/shared-styles.html">
<link rel="import" href="../../../styles/risk-rating-styles.html">




<link rel="import" href="../../../styles/shared-styles.html">

<dom-module id="partner-overview">

  <template>

    <style include="page-layout-styles grid-layout-styles shared-styles risk-rating-styles">
      :host {
        @apply(--layout-horizontal);
        width: 100%;

        --etools-checkable-input-label: {
          padding-bottom: 2px;
        }
      }

      paper-input,
      paper-dropdown-menu {
        width: 100%;
      }

      paper-material paper-toolbar {
        --paper-toolbar-height: 40px;
        --paper-toolbar-background: #F2F2F2; /* TODO: replace with app-theme var */
        --paper-toolbar: {
          -webkit-border-radius: 8px;
          -moz-border-radius: 8px;
          border-radius: 8px;
        };
        --paper-toolbar-title: {
          @apply(--nested-content-panel-title);
          margin-left: 0;
        };
      }

      .assessments {
        margin-top: 20px;
      }

      #core-values-assessment {
        width: 100%;
      }

      .hact-heading {
        @apply(--layout-vertical);
        margin-top: 20px;
        background-color: #EDEDED; /* TODO: replace with app-theme var */
        -webkit-border-radius: 8px;
        -moz-border-radius: 8px;
        border-radius: 8px;        
      }
      
      .hact-heading .row-h {
        padding: 8px;
      }
      .hact-heading .row-h .col {
        justify-content: center;             
      } 
      .hact-body {
        @apply(--layout-vertical);
        margin-top: 20px;        
      }
      
      .hact-body .row-h {
        padding: 8px;
      }
      .hact-body .row-h .col {
        align-items: center;
        justify-content: center;     
        text-align: center;        
      }
      .row-h + .row-h {
        margin-top: 0;
        border-top: 1px solid var(--dark-divider-color);
      }      
      .full-width {
        width: 100%
      }
      .green {
        color: var(--paper-green-500);
      }
      .block {
        display: block;
      }
      small {
        color: var(--dark-secondary-text-color);
      }

    </style>

    <!-- partner overview content goes here... -->
    <div id="pageContent">

      <etools-content-panel class="content-section" title="HACT Assurance & Partnerships">        
        <div class="hact-heading">
          <div class="row-h">
            <div class="col col-6"><strong> TOTAL CASH TRANSFERS </strong></div>
            <div class="col col-2"><strong> PROG.VISIT </strong></div>
            <div class="col col-2"><strong> SPOT CHECK </strong></div>
            <div class="col col-2"><strong> AUDIT </strong></div>            
          </div>
          <div class="row-h">
            <div class="col col-2"> Risk Rating </div>
            <div class="col col-2"> Current CP Cycle </div>
            <div class="col col-2"> Current Year </div>
            <div class="col col-2"> Done / M.R. </div>
            <div class="col col-2"> Done / M.R. </div>
            <div class="col col-2"> Done / M.R. </div>            
          </div>
        </div>    
        <div class="hact-body">
          <div class="row-h">
            <div class="col col-2"> 
              <paper-input class$="risk-rating-field [[getRiskRatingClass(partner.rating)]]"
                         value="[[getRiskRatingValue(partner.rating)]]"
                         readonly ></paper-input>
            </div>
            <div class="col col-2"> $[[partner.total_ct_cp]] </div>
            <div class="col col-2 block">  $[[partner.total_ct_cy]] <br> <small>out of $[[partner.hact_values.planned_cash_transfer]] planned </small> </div>
            <div class="col col-2"> <strong><span class="green"> [[partner.hact_values.planned_visits]] </span> / [[partner.hact_values.planned_visits]] </div></strong>
            <div class="col col-2"> <strong><span class="green"> [[partner.hact_values.spot_checks]] </span> / 2 </div></strong>
            <div class="col col-2"> <strong><span class="green"> [[partner.hact_values.audits_done]] </span> / [[partner.hact_values.audits_mr]] </div></strong>
          </div>
        </div>
      

        <div class="hact-heading">
          <div class="row-h">
            <div class="col col-6"> Partnership </div>
            <div class="col col-2"> Status </div>            
            <div class="col col-4"> Timeline </div>
          </div>
        </div>
        <div class="hact-body">
          <div class="row-h">
            <div class="col col-6 block"> 
              <strong><a href="#">LEBA/PD/232671</a></strong> <br>
              Basic Literacy and numeracy programming for out-of-school children in Lebanon
            </div>
            <div class="col col-2"> <strong class="green">ACTIVE</strong> </div>            
            <div class="col col-4"> 12 Apr 2016 - 16 Feb 2017 </div>
          </div>
        </div>
      </etools-content-panel>    

    </div> <!-- main page content end -->

    <!-- sidebar content start -->
    <div id="sidebar">
      <partner-status on-save-partner="_validateAndTriggerPartnerSave" partner="[[partner]]"></partner-status>
    </div>

  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'partner-overview',

        behaviors: [        
          pmpBehaviors.CommonGeneralBehavior,
          pmpBehaviors.RiskRatingBehavior
        ],

        properties: {
          user: Object,
          permissions: Object,

          partner: {
            type: Object,
            value: {},
            notify: true,
            observer: '_partnerChanged'
          },
          contentVisible: {
            type: Boolean,
            value: false
          },
          coreValuesAssessmentFiles: {
            type: Array,
            value: [],
            notify: true
          },
          originalPartnerData: Object
        },

        ready: function() {
          console.log('overview page ready');
        },

        _partnerChanged: function(partner) {
          if (typeof partner === 'object' && Object.keys(partner).length > 0) {
            this.contentVisible = true;
            
            console.log(partner);


          } else {
            this.contentVisible = false;
          }
        },

      });

    })();
  </script>

</dom-module>

<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/etools-ajax/etools-ajax.html">

<dom-module id="partner-item-data">

  <template>
    <etools-ajax id="ajax"
                endpoint="[[endpoint]]"
                on-success="_handleResponse"></etools-ajax>
  </template>

  <script>

    Polymer({

      is: 'partner-item-data',
      behaviors: [etoolsAppConfig.globals],
      properties: {

        partner: {
          type: Object,
          readOnly: true,
          notify: true
        },
        endpoint: {
          type: Object,
          reflectToAttribute: true
        },

        _partners: {
          type: Object
        },

        partnerId: {
          type: Number,
          notify: true,
          observer: '_partnerIdChanged'
        }

      },

      _partnerIdChanged: function(newId) {
        if (newId) {
            // set an empty partner
            this._setPartner({});
            // set the new endpoint
            //TODO: fire a loading event from here or etools ajax for side page load
            //this.$.fire('partial-loading', {element:'Partner Details'})
            this.$.ajax.set('endpoint', this.getEndpoint('partnerDetails', {id: newId}));
        }
      },

      _handleResponse: function(response) {
        this._setPartner(response.detail);
      }

    });

  </script>

</dom-module>

<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/etools-content-panel/etools-content-panel.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../app-config/etools-app-config.html">
<link rel="import" href="../../../styles/buttons-styles.html">

<dom-module id="etools-error-messages-box">

  <template>
    <style include="buttons-styles">
      :host {
        @apply(--layout-horizontal);
        @apply(--layout-flex);
        @apply(--etools-error-messages-box);
      }
      :host([hidden]) {
        display: none;
      }
      etools-content-panel {
        width: 100%;
      }
      .errors-box {
        margin-bottom: 25px;
      }

      .errors-box {
        /* TODO: replace colors with app-theme variables */
        --ecp-header-bg: var(--error-box-heading-color);
        --ecp-content: {
          color: var(--error-box-text-color);
          background-color: var(--error-box-bg-color);
          border-color: var(--error-box-border-color);
        };
      }

      ul {
        padding: 0 0 0 20px;
        margin: 0;
      }
      .errors-box-actions {
        margin-top: 20px;
        @apply(--layout-horizontal);
        @apply(--layout-end-justified);
      }
      paper-button {
        margin: 0;
      }
    </style>

    <etools-content-panel class="errors-box" title="[[title]]">
      <ul>
        <template is="dom-repeat" items=[[errors]]>
          <li>[[item]]</li>
        </template>
      </ul>

      <div class="errors-box-actions">
        <paper-button class="primary-btn danger-btn"
                      on-tap="_resetErrors"
                      hidden$="[[_hideSuspendAndTerminateBtns(status)]]">
          Ok
        </paper-button>
      </div>
    </etools-content-panel>

  </template>

  <script>
    (function() {
      'use strict';

      Polymer({

        is: 'etools-error-messages-box',

        properties: {
          title: String,
          errors: {
            type: Array,
            value: [],
            notify: true
          },
          hidden: {
            type: Boolean,
            computed: '_errorsLengthChanged(errors)',
            reflectToAttribute: true
          }
        },

        _errorsLengthChanged: function(errors) {
          if (!errors || (errors && !errors.length)) {
            return true;
          }
          return false;
        },

        _resetErrors: function() {
          this.set('errors', []);
        },
        _hideSuspendAndTerminateBtns: function(status) {
          return status !== 'active';
        },

      });
    })();
  </script>

</dom-module>

<!--
Nothing is editable in this element, we only use it to display amendment data and
keep amendments element small and easy to understand
-->
<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-input/paper-textarea.html">

<link rel="import" href="../../../bower_components/etools-file/etools-file.html">

<link rel="import" href="../../app-behaviors/date-behavior.html">
<link rel="import" href="./agreement-behaviors/agreement-amendments-behavior.html">

<link rel="import" href="../../../styles/grid-layout-styles.html">
<link rel="import" href="../../../styles/shared-styles.html">
<link rel="import" href="../../../styles/file-styles.html">


<dom-module id="agreement-amendment-details">
  <template>
    <style include="grid-layout-styles shared-styles file-styles">

      :host {
        display: block;
        width: 100%;
      }

      .row-h.notes {
        font-style: italic;
        margin-top: 0;
      }

      .amendment-type-item + .amendment-type-item {
        margin-top: 15px;
      }

      paper-input, paper-textarea {
        width: 100%;
      }

      .amendment-type-item .row-h {
        margin-top: 0;
      }

    </style>

    <div class="row-h">
      <div class="col col-3">
        <!-- Signed Date -->
        <paper-input label="Signed Date"
                     value="[[prettyDate(amendment.signed_date)]]"
                     readonly>
        </paper-input>
      </div>
      <div class="col col-9">
        <!-- Signed Amendment -->
        <etools-file label="Signed Amendment"
                     files="[[prepareAttachementFile(amendment.signed_agreement)]]"
                     readonly>
        </etools-file>
      </div>
    </div>

    <template is="dom-repeat" items="[[amendment.amendment_types]]" as="amendmentType"
              index-as="amendmentTypeIndex">

      <div class="amendment-type-item">

        <div class="row-h">
          <!-- Amendment Type -->
          <paper-input label="Amendment Type"
                       value="[[amendmentType.amendment_type]]"
                       readonly>
          </paper-input>
        </div>

        <div class="row-h">

          <template is="dom-if" if="[[showAmendmentTypeOfficer(amendmentType.amendment_type)]]">
            <!-- Officer -->
            <paper-input label="Officer"
                         value="[[getOfficerName(amendmentType.officer_id)]]"
                         readonly>
            </paper-input>
          </template>

          <template is="dom-if" if="[[showAmendmentTypeBankInfo(amendmentType.amendment_type)]]">
            <!-- Bank information -->
            <paper-input label="New Bank Account"
                         value="[[amendmentType.bank_info]]"
                         readonly>
            </paper-input>
          </template>

          <template is="dom-if" if="[[showAmendmentTypeLegalNameOfIp(amendmentType.amendment_type)]]">
            <!-- Legal name of IP -->
            <paper-input label="Full Name of Implementing Partner"
                         value="[[amendmentType.legal_name_of_ip]]"
                         readonly>
            </paper-input>
          </template>

          <template is="dom-if"
                    if="[[showAmendmentTypeExtensionProgrammeCycle(amendmentType.amendment_type)]]">
            <!-- End Date -->
            <paper-input label="CP Cycle End Date"
                         value="[[prettyDate(amendmentType.cp_cycle_end)]]"
                         readonly>
            </paper-input>
          </template>

          <template is="dom-if" if="[[showAmendmentTypeAdditionalClauses(amendmentType.amendment_type)]]">
            <!-- Additional Clauses -->
            <paper-textarea label="Additional Clauses"
                            value="[[amendmentType.additional_clauses]]"
                            readonly>
            </paper-textarea>
          </template>

          <template is="dom-if" if="[[showAmendmentTypeExistingClauseAmended(amendmentType.amendment_type)]]">
            <!-- Change Existing Clauses -->
            <paper-textarea label="Clause Change"
                            value="[[amendmentType.existing_clause_amended]]"
                            readonly>
            </paper-textarea>
          </template>

        </div>
      </div>

    </template>

  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        is: 'agreement-amendment-details',

        behaviors: [
          pmpBehaviors.DateBehavior,
          pmpBehaviors.AgreementAmendmentsBehavior
        ],

        properties: {
          amendment: {
            type: Object
          }
        }

      });
    })();
  </script>
</dom-module>

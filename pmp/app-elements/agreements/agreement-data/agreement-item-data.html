<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/etools-ajax/etools-ajax.html">

<dom-module id="agreement-item-data">

  <template>
    <etools-ajax id="ajax"
                 endpoint="[[endpoint]]"
                 caching-storage="dexie"
                 on-success="_handleResponse"></etools-ajax>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({

        is: 'agreement-item-data',
        behaviors: [etoolsAppConfig.globals],
        properties: {

          agreement: {
            type: Object,
            readOnly: true,
            notify: true
          },

          _partners: {
            type: Object
          },

          agreementId: {
            type: Number,
            notify: true,
            observer: '_agreementIdChanged'
          }

        },
        _agreementIdChanged: function(newId) {
          if (newId) {
            this.fire('global-loading', {message: 'Loading agreement data...', active: true});
            this.$.ajax.set('endpoint', this.getEndpoint('agreementDetails', {id: newId}));
          }
        },
        _handleResponse: function(response) {
          this._setAgreement(response.detail);
        },

        saveAgreement: function(agreement) {

        }

      });
    })();
  </script>

</dom-module>

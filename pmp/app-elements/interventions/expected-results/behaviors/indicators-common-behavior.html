
<script>
  window.EtoolsPmpApp = window.EtoolsPmpApp || {};
  window.EtoolsPmpApp.Behaviors = window.EtoolsPmpApp.Behaviors || {};
  /** @polymerBehavior EtoolsPmpApp.Behaviors.IndicatorsCommonBehavior */
  EtoolsPmpApp.Behaviors.IndicatorsCommonBehavior = {
    _baselineChanged: function(baseline) {
      if (!baseline || !this.indicator) {
        if (this.indicator) {
          this.indicator.baseline = null; //* Avoid empty string or undefined being sent to backend
        }
        return;
      }
      if (this.indicator.indicator && this.indicator.indicator.unit === 'percentage') {
        let val = this._getValidPercentageValue(baseline);
        this.set('indicator.baseline', val);
      }
     },
    _targetChanged: function(target) {
      if (!target || !this.indicator) {
        return;
      }
      if (this.indicator.indicator && this.indicator.indicator.unit === 'percentage') {
        let val = this._getValidPercentageValue(target);
        this.set('indicator.target', val);
      }
    },
    _getValidPercentageValue: function(val) {
      val = parseInt(val, 10);
      if (isNaN(val) || val < 0) {
        val = 0;
      }
      if (val > 100) {
        val = 100;
      }
      return val;
    },
    validateComponents: function(elemIds) {
      let valid = true;
      let i;
      for (i = 0; i < elemIds.length; i++) {
        let elem = this.$$('#' + elemIds[i]);
        if (elem) {
          if (!elem.validate()) {
            valid = false;
          }
        } else {
          this.logWarn('Elem ' + elemIds[i] + ' not found');
        }
      }
      return valid;
    }
  };
</script>

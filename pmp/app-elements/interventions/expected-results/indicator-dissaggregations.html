<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../../../bower_components/paper-icon-button/paper-icon-button.html">

<link rel="import" href="../../../../styles/grid-layout-styles.html">
<link rel="import" href="../../../../styles/shared-styles.html">
<link rel="import" href="../../../../styles/repeatable-data-sets-styles.html">

<link rel="import" href="../../../app-behaviors/repeatable-data-sets-behavior.html">

<dom-module id="indicator-dissaggregations">
  <template strip-whitespace>
    <style include="grid-layout-styles shared-styles repeatable-data-sets-styles">
      [hidden] {
        display: none !important;
      }

      :host {
        display: block;
        width: 100%;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;

        --paper-fab-keyboard-focus-background: var(--success-color);
        --paper-fab: {
          @apply(--paper-fab-btn-green);
        };
      }

      paper-input {
        width: 100%;
      }

    </style>

    <div hidden$="[[_emptyList(dataItems.length)]]">
      <template is="dom-repeat" items="{{dataItems}}">
        <div class="row-h item-container no-h-margin">
          <div class="item-actions-container">
            <div class="actions">
              <paper-icon-button class="action delete"
                                 on-tap="_openDeleteConfirmation"
                                 data-args$="[[index]]"
                                 icon="cancel"></paper-icon-button>
            </div>
          </div>
          <div class="item-content">
            <div class="row-h">
              <div class="col col-4">
                <paper-input label="Disaggregate By" value="{{item.disaggregate_by}}"></paper-input>
              </div>
              <div class="col col-8">
                <paper-input label="Disaggregation Groups" value="{{item.disaggregation_groups}}"></paper-input>
              </div>
            </div>
          </div>
        </div>
      </template>
    </div>

    <div class="row-h" hidden$="[[!_emptyList(dataItems.length)]]">
      <p>There are no disaggregations added.</p>
    </div>

    <div id="bottom-actions" hidden$="[[!editMode]]">
      <paper-fab icon="add"
                 on-tap="_addNewDisaggregation"
                 title="Add"></paper-fab>
    </div>

  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'indicator-dissaggregations',

        behaviors: [
          pmpBehaviors.RepeatableDataSetsBehavior
        ],

        properties: {

        },

        ready: function() {
          this.dataSetModel = {
            disaggregate_by: null,
            disaggregation_groups: null
          };
          this.set('editMode', true);
        },

        /**
         * Validate last amendment type; if valid add a new one.
         */
        _addNewDisaggregation: function() {
          this._addElement();
          this.fire('disaggregation-change');
        }

      });
    })();
  </script>
</dom-module>

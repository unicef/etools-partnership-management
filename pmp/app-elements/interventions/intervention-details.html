<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-input/paper-textarea.html">

<link rel="import" href="../../../bower_components/etools-content-panel/etools-content-panel.html">
<link rel="import" href="../../../bower_components/etools-searchable-multiselection-menu/etools-searchable-multiselection-menu.html">

<link rel="import" href="../../../styles/page-layout-styles.html">
<link rel="import" href="../../../styles/grid-layout-styles.html">
<link rel="import" href="../../../styles/shared-styles.html">

<link rel="import" href="../../app-behaviors/common-general-behavior.html">
<link rel="import" href="../static-common-data/redux-behaviors/common-static-data-redux-behavior.html">

<dom-module id="intervention-details">

  <template>

    <style include="page-layout-styles grid-layout-styles shared-styles">
      :host {
        @apply(--layout-horizontal);
        width: 100%;
      }
      paper-input,
      paper-textarea {
        width: 100%;
      }
    </style>

    <div id="pageContent">
      <etools-content-panel class="content-section" title="Partnership Information">
        <div class="row-h flex-c">
          <div class="col col-3">
            <etools-searchable-multiselection-menu id="partner"
                                                   label="Partner"
                                                   placeholder="&#8212;"
                                                   options="[[partnersDropdownData]]">
            </etools-searchable-multiselection-menu>
          </div>
          <div class="col col-3">
            <etools-searchable-multiselection-menu id="agreement"
                                                   label="Agreement"
                                                   placeholder="&#8212;"
                                                   options="[[agreementsDropdownData]]">
            </etools-searchable-multiselection-menu>
          </div>
          <div class="col col-3">
            <etools-searchable-multiselection-menu id="documentType"
                                                   label="Document Type"
                                                   placeholder="&#8212;"
                                                   options="[[_prepareDropdownDocTypes(documentTypes)]]">
            </etools-searchable-multiselection-menu>
          </div>
          <div class="col col-3">
            <!-- Reference Number -->
            <paper-input label="Reference Number"
                         value="[[intervention.number]]"
                         placeholder="&#8212;"
                         disabled></paper-input>
          </div>
        </div>
        <div class="row-h flex-c">
          <!-- Title -->
          <paper-input label="Title"
                       value="{{intervention.title}}"
                       placeholder="&#8212;"></paper-input>
        </div>
        <div class="row-h flex-c">
          <div class="col col-6">
            <etools-searchable-multiselection-menu id="unicefOffices"
                                                   label="UNICEF Office(s)"
                                                   placeholder="&#8212;"
                                                   options="[[offices]]">
            </etools-searchable-multiselection-menu>
          </div>
          <div class="col col-6">
            <etools-searchable-multiselection-menu id="unicefFocalPts"
                                                   label="UNICEF Focal Points(s)"
                                                   placeholder="&#8212;"
                                                   options="[[unicefUsersData]]">
            </etools-searchable-multiselection-menu>
          </div>
        </div>
        <div class="row-h flex-c">
          <div class="col col-6">
            <etools-searchable-multiselection-menu id="partnerFocalPts"
                                                   label="Partner Focal Points(s)"
                                                   placeholder="&#8212;"
                                                   options="[[partnerStaffMembersDropdownData]]">
            </etools-searchable-multiselection-menu>
          </div>
        </div>

      </etools-content-panel>
      <etools-content-panel class="content-section" title="PD or SSFA Details">
        <div class="row-h flex-c">
          <div class="col col-3">
            <etools-searchable-multiselection-menu id="hrps"
                                                   label="In response to an HRP, Select"
                                                   placeholder="&#8212;"
                                                   options="[[hrps]]">
            </etools-searchable-multiselection-menu>
          </div>
          <div class="col col-3">
            <!-- Start date -->
            <paper-input label="Start Date"
                         value="[[prettyDate(intervention.start)]]"
                         placeholder="&#8212;"
                         disabled>
              <div prefix>
                <iron-icon icon="date-range"></iron-icon>
              </div>
            </paper-input>
          </div>
          <div class="col col-3">
            <!-- Start date -->
            <paper-input label="End Date"
                         value="[[prettyDate(intervention.end)]]"
                         placeholder="&#8212;"
                         disabled>
              <div prefix>
                <iron-icon icon="date-range"></iron-icon>
              </div>
            </paper-input>
          </div>
        </div>
        <div class="row-h flex-c">
          <!-- Population Focus -->
          <paper-textarea label="Population Focus"
                       value="{{intervention.population_focus}}"
                       placeholder="&#8212;"></paper-textarea>
        </div>
        <div class="row-h flex-c">
          <etools-searchable-multiselection-menu id="sectors"
                                                 label="Sectors"
                                                 placeholder="&#8212;"
                                                 options="[[sectors]]">
          </etools-searchable-multiselection-menu>
        </div>
        <div class="row-h flex-c">
          <!-- TODO: do we need locations here? -->
          <etools-searchable-multiselection-menu id="locations"
                                                 label="Locations"
                                                 placeholder="&#8212;"
                                                 options="[[locations]]">
          </etools-searchable-multiselection-menu>
        </div>
      </etools-content-panel>
      <!--<etools-content-panel class="content-section" title="Expected results">-->

      <!--</etools-content-panel>-->
      <etools-content-panel class="content-section" title="Planned Budget">

      </etools-content-panel>
      <etools-content-panel class="content-section" title="Planned Visits">

      </etools-content-panel>
    </div> <!-- main page content end -->

    <!-- sidebar content start -->
    <div id="sidebar">
      <intervention-status status="[[intervention.status]]"></intervention-status>
    </div>
    <!-- sidebar content end -->


  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'intervention-details',

        behaviors: [
          pmpBehaviors.EtoolsStaticCommonDataReduxBehavior,
          pmpBehaviors.CommonGeneralBehavior
        ],

        properties: {
          intervention: {
            type: Object,
            observer: '_interventionChanged'
          },
          partnersDropdownData: {
            type: Array,
            value: []
          },
          partnerStaffMembersDropdownData: {
            type: Array,
            value: []
          },
          agreementsDropdownData: {
            type: Array,
            value: []
          },
          documentTypes: {
            type: Array,
            statePath: 'interventionDocTypes'
          },
          offices: {
            type: Array,
            statePath: 'offices'
          },
          unicefUsersData: {
            type: Array,
            statePath: 'unicefUsersData'
          },
          hrps: {
            type: Array,
            statePath: 'hrps'
          },
          sectors: {
            type: Array,
            statePath: 'sectors'
          }
        },

        _interventionChanged: function(intervention) {
          console.log(intervention);

          this.fire('global-loading', {active: false});
        },

        _prepareDropdownDocTypes: function(types) {
          return types.map(function(type, index) {
            return {
              value: (index + 1),
              label: type.value
            }
          });
        }
      });

    })();
  </script>

</dom-module>

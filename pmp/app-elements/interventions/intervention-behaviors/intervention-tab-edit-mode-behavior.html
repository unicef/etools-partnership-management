<script>
  window.pmpBehaviors = window.pmpBehaviors || {};
  /** @polymerBehavior pmpBehaviors.InterventionTabEditModeBehavior */
  pmpBehaviors.InterventionTabEditModeBehavior = {

    properties: {
      editMode: {
        type: Boolean,
        value: false,
        observer: '_editModeChanged'
      },
      tabEditMode: {
        type: Boolean,
        observer: '_tabEditModeChanged'
      }
    },

    _tabEditModeChanged: function() {
      this.updateStyles();
    },

    _editModeChanged: function(newValue) {
      if (newValue !== this.tabEditMode) {
        this.setTabEditMode(newValue);
      }
    },

    setTabEditMode: function(editMode) {
      if (!editMode) {
        this.set('tabEditMode', editMode);
        return;
      }

      if (this.permissions.partnershipManager) {
        // TODO: revise this temporary permission
        // temporary edit permission for PM regardless status
        this.set('tabEditMode', true);
        return;
      }

      if (!this.intervention) {
        this.set('tabEditMode', false);
        return;
      }

      if (!(this.permissions.partnershipManager || this.permissions.PME) &&
          (!this.intervention.status || this.intervention.status !== 'draft')) {
        this.set('tabEditMode', false);
      } else {
        this.set('tabEditMode', true);
      }
    }

  };
</script>

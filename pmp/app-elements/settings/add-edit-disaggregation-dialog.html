<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/etools-dialog/etools-dialog.html">

<link rel="import" href="../../app-behaviors/repeatable-data-sets-behavior.html">

<link rel="import" href="../../../styles/grid-layout-styles.html">
<link rel="import" href="../../../styles/repeatable-data-sets-styles.html">
<link rel="import" href="../../../styles/buttons-styles.html">
<link rel="import" href="../../../styles/shared-styles.html">

<dom-module id="add-edit-disaggregation-dialog">
  <template>
    <style include="grid-layout-styles repeatable-data-sets-styles buttons-styles shared-styles">
      .groups {
       align-items: flex-start;
       flex-wrap: wrap;
      }
      .newGroup {
        width: 80px;
      }
      .action.delete.no-padding {
        padding-top: 0px !important;
        padding-bottom: 0px !important;
        height: 20px;
      }
      etools-dialog paper-input.newGroup {
        --paper-input-container: {
          padding: 0px 0px !important;
        };
      }

    </style>

    <etools-dialog keep-dialog-open id="etoolsDialog" size="lg" ok-btn-text="Save"
      dialog-title="Add/Edit Disaggregation"
      on-confirm-btn-clicked="_validateAndSaveDisaggregation">
      <div class="row-h flex-c">
        <div class="col col-4">
          <paper-input label="Disaggregation" value="{{disaggregation.name}}"
                                  placeholder="&#8212;">
          </paper-input>
        </div>
        <div class="col col-8">
          <div class="layout-vertical">
            <label class="paper-label">Disaggregation Group</label>
            <div class="layout-horizontal groups">
              <template is="dom-repeat" items="[[dataItems]]">

              <span hidden$="[[_isNew(item)]]">[[item.name]]</span>
              <paper-input class="newGroup" hidden$="[[!_isNew(item)]]" no-label-float
                label="New Group"
                value="{{item.name}}"></paper-input>
                <paper-icon-button class="action delete no-padding" icon="cancel"
                  on-tap="_openDeleteConfirmation"
                  data-args$="[[index]]"
                  title="Delete">
                </paper-icon-button>
              </template>
              <paper-button class="secondary-btn" on-tap="_addNewGroup"
                    title="Add Disaggregation Group">+Add </paper-button>
            </div>
          </div>
        </div>
      </div>
    </etools-dialog>

 </template>
</dom-module>

<script>
  (function() {
    'use strict';
    Polymer({
      is: 'add-edit-disaggregation-dialog',
      behaviors: [
        EtoolsPmpApp.Behaviors.RepeatableDataSets
      ],
      properties: {
        dataItems: {
          type: Array,
          value: [{'name': '1-20', 'gId':1},{'name':'21-40', gId: 2}]
        }
      },
      ready: function() {
        this.dataSetModel = {'name': null, 'gId': null};
        this.editMode = true;
      },
      _isNew: function(item) {
        return !!!item.gId;
      },
      open: function() {
        this.$.etoolsDialog.opened = true;
      },
      _addNewGroup: function() {
        this._addElement();
      },
      _validateAndSaveDisaggregation: function() {

      }
    });
  })();
</script>

<link rel="import" href="../../../../bower_components/polymer-redux/polymer-redux.html">

<script>
  // shuts up the linting script
  var Redux = Redux || {};
  var PolymerRedux = PolymerRedux || {};

  var initialDropdownPmpData = {
    fileTypes: [],
    signedByUnicefUsers: [],
    cpOutputs: [],
    countryProgrammes: [],
    interventionDocTypes: [],
    interventionStatuses: [],
    sectors: [],
    sections: [],
    unicefUsersData: [],
    locations: [],
    offices: [],
    partners: [],
    agreementsDropdownData: [],
    partnersDropdownData: [],
    agreementsList: [],
    agencyChoices: [],
    agreementAmendmentTypes: [],
    csoTypes: [],
    partnerTypes: [],
    assessmentTypes: [],
    interventionAmendmentTypes: [],
    currencies: [],
    agreementTypes: [],
    agreementStatuses: [],
    csoPartners: [],
    countryData: {},
    disaggregations: []
  };

  var commonStaticDataStore = Redux.createStore(function(state, action) {
    if (!state) {
      return initialDropdownPmpData;
    }

    switch (action.type) {
      case 'SET_FILE_TYPES':
        // console.log('set fileTypes data...', action.fileTypes);
        return Object.assign({}, state, {fileTypes: action.fileTypes});

      case 'SET_CP_OUTPUTS':
        // console.log('set cp_outputs data...', action.cpOutputs);
        return Object.assign({}, state, {cpOutputs: action.cpOutputs});

      case 'SET_CP_DATA':
        // console.log('set countryProgrammes data...', action.countryProgrammes);
        return Object.assign({}, state, {countryProgrammes: action.countryProgrammes});

      case 'SET_SIGNED_BY_UNICEF_USERS':
        // console.log('set signed_by_unicef_users data...', action.signedByUnicefUsers);
        return Object.assign({}, state, {signedByUnicefUsers: action.signedByUnicefUsers});

      case 'SET_INTERVENTION_DOC_TYPES':
        // console.log('set interventionDocTypes data...', action.interventionDocTypes);
        return Object.assign({}, state, {interventionDocTypes: action.interventionDocTypes});

      case 'SET_INTERVENTION_STATUSES':
        // console.log('set interventionStatuses data...', action.statuses);
        return Object.assign({}, state, {interventionStatuses: action.statuses});

      case 'SET_SECTORS':
        // console.log('set sectors data...', action.sectors);
        return Object.assign({}, state, {sectors: action.sectors});

      case 'SET_SECTIONS':
        // console.log('set sectors data...', action.sectors);
        return Object.assign({}, state, {sections: action.sections});

      case 'SET_LOCATIONS':
        // console.log('set locations data...', action.locations);
        return Object.assign({}, state, {locations: action.locations});

      case 'SET_UNICEF_USERS_DATA':
        // console.log('set unicefUsersData data...', action.unicefUsersData);
        return Object.assign({}, state, {unicefUsersData: action.unicefUsersData});

      case 'SET_OFFICES':
        // console.log('set offices data...', action.offices);
        return Object.assign({}, state, {offices: action.offices});

      case 'SET_PARTNERS':
        //console.log('set partners data...', action.partners);
        return Object.assign({}, state, {partners: action.partnersData});

      case 'SET_AGREEMENTS':
        //console.log('set partners data...', action.partners);
        return Object.assign({}, state, {agreementsList: action.agreementsList});

      case 'ADD_EDIT_AGREEMENT':
        let agreementsCopy = state.agreementsList.slice(0);
        let index = agreementsCopy.findIndex(function(agr) {
          return agr.id === action.agreement.id;
        });

        if (index > -1) {
          agreementsCopy[index] = action.agreement;
        } else {
          agreementsCopy.push(action.agreement);
        }
        return Object.assign({}, state, {agreementsList: agreementsCopy});

      case 'SET_PARTNERS_DROPDOWN':
        // console.log('set offices data...', action.partnersDropdownData);
        return Object.assign({}, state, {partnersDropdownData: action.partnersDropdownData});
      case 'DELETE_PARTNER':
        let csoPartnerCopy = state.csoPartners.slice(0);
        let partnersDdDataCopy = state.partnersDropdownData.slice(0);

        let indexP = csoPartnerCopy.findIndex(function(partner) {
          return partner.id === action.partnerId;
        });
        if (indexP > -1) {
          csoPartnerCopy.splice(indexP, 1);
        }
        indexP = partnersDdDataCopy.findIndex(function(partner) {
          return partner.value === action.partnerId;
        });
        if (indexP > -1) {
          partnersDdDataCopy.splice(indexP, 1);
        }
        return Object.assign({}, state, {partnersDropdownData: partnersDdDataCopy,
                                         csoPartners: csoPartnerCopy});

      case 'SET_AGREEMENTS_DROPDOWN':
        // console.log('set offices data...', action.partnersDropdownData);
        return Object.assign({}, state, {agreementsDropdownData: action.agreementsDropdownData});

      case 'SET_CURRENCIES':
        // console.log('set currencies data...', action.currencies);
        return Object.assign({}, state, {currencies: action.currencies});

      case 'SET_AGREEMENT_TYPES':
        // console.log('set agreement_types data...', action.agreementTypes);
        return Object.assign({}, state, {agreementTypes: action.agreementTypes});

      case 'SET_AGREEMENT_STATUSES':
        // console.log('set agreement_statuses data...', action.statuses);
        return Object.assign({}, state, {agreementStatuses: action.statuses});

      case 'SET_CSO_PARTNERS':
        // console.log('set cso partners data...', action.csoPartners);
        return Object.assign({}, state, {csoPartners: action.csoPartners});

      case 'SET_CSO_TYPES':
        return Object.assign({}, state, {csoTypes: action.csoTypes});

      case 'SET_PARTNER_TYPES':
        // console.log('set partnerTypes...', action.partnerTypes);
        return Object.assign({}, state, {partnerTypes: action.partnerTypes});

      case 'SET_AGENCY_CHOICHES':
        // console.log('set agencyChoices...', action.agencyChoices);
        return Object.assign({}, state, {agencyChoices: action.agencyChoices});

      case 'SET_AGREEMENT_AMENDMENT_TYPES':
        // console.log('set agreementAmendmentTypes...', action.agreementAmendmentTypes);
        return Object.assign({}, state, {agreementAmendmentTypes: action.agreementAmendmentTypes});

      case 'SET_ASSESSMENT_TYPES':
        // console.log('set assessmentTypes...', action.assessmentTypes);
        return Object.assign({}, state, {assessmentTypes: action.assessmentTypes});

      case 'SET_INTERVENTION_AMENDMENT_TYPES':
        // console.log('set interventionAmendmentTypes...', action.interventionAmendmentTypes);
        return Object.assign({}, state, {interventionAmendmentTypes: action.interventionAmendmentTypes});

      case 'SET_USER_COUNTRY_DATA':
        return Object.assign({}, state, {countryData: action.countryData});
      case 'SET_DISAGGREGATIONS_DATA':
        return Object.assign({}, state, {disaggregations: action.disaggregations});
    }
  });
  window.EtoolsPmpApp = window.EtoolsPmpApp || {};
  window.EtoolsPmpApp.Behaviors = window.EtoolsPmpApp.Behaviors || {};
  /** @polymerBehavior EtoolsPmpApp.Behaviors.EtoolsDataReduxStore */
  EtoolsPmpApp.Behaviors.EtoolsDataReduxStore = PolymerRedux(commonStaticDataStore);
</script>

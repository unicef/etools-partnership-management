<link rel="import" href="../../../../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../../../../bower_components/etools-dialog/etools-dialog.html">

<dom-module id="new-partner-dialog">
  <template>
    <style>
     #vendorNo {
      margin-bottom: 30px;
    }
    </style>

    <etools-dialog id="newPartnerDialog" size="md" ok-btn-text="Save" disable-confirm-btn="[[vendorNumberIsEmpty]]"
       dialog-title="New Partner" on-close="_handleDialogClosed">

    <paper-input id="vendorNo" label="Vendor #" value="{{vendor_number}}"
      placeholder="&#8212;" autofocus
      required auto-validate error-message="Vendor# is required"
      allowed-pattern="[0-9]"
      char-counter
      maxlength="11"></paper-input>

    </etools-dialog>

  </template>
  <script>
    'use strict';
    /**
     * @polymer
     * @customElement
     */
    class NewPartnerDialog extends Polymer.Element {

      static get is() {
        return 'new-partner-dialog';
      }

      static get properties() {
        return {
          vendor_number: {
          type: String
          },
          vendorNumberIsEmpty: {
            type: Boolean,
            computed: '_vendorNumberIsEmpty(vendor_number)'
          }
        };
      }

      openNewPartnerDialog() {
        this.$.vendorNo.invalid = false;
        this.$.newPartnerDialog.opened = true;
      }
      _vendorNumberIsEmpty() {
        return !!!this.vendor_number;
      }

      _handleDialogClosed(closingReason) {
        if (closingReason.detail.confirmed) {
          if (!this.vendor_number) {
            return;
          }
          this.dispatchEvent(new CustomEvent('create-partner',
          {detail: {vendor: this.vendor_number}, composed: true, bubbles: true}));
        } else {
          this.vendor_number = '';
        }
      }
    }

    window.customElements.define(NewPartnerDialog.is, NewPartnerDialog);
  </script>
</dom-module>

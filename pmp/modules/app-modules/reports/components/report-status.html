<link rel="import" href="../../../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../../../bower_components/iron-icons/image-icons.html">
<link rel="import" href="../../../../../bower_components/polymer/lib/elements/dom-if.html">

<dom-module id="report-status">
  <template>
    <style>
      :host {
        display: inline-block;
      }

      iron-icon {
        --iron-icon-width: 16px;
        --iron-icon-height: 16px;
        padding-right: 4px;
        margin-top: -2px;
      }

      :host([status-type="success"]) iron-icon {
        color: var(--success-color);
      }

      :host([status-type="error"]) iron-icon {
        color: var(--dark-error-color);
      }

      :host([status-type="neutral"]) iron-icon {
        color: var(--primary-color);
      }

      :host([status-type="warning"]) iron-icon {
        color: var(--warning-color);
      }

      :host([status-type="no-status"]) iron-icon {
        color: var(--medium-icon-color);
      }
    </style>

    <template is="dom-if" if="[[!noIcon]]">
        <iron-icon icon$="[[icon]]"></iron-icon>
    </template>
    <template is="dom-if" if="[[!noLabel]]">
      <span>[[label]]</span>
    </template>

  </template>

  <script>

    /**
     * @customElement
     * @polymer
     * @extends {Polymer.Element}
     */
    class ReportStatus extends Polymer.Element {
      static get is() {
        return 'report-status';
      }

      static get properties() {
        return {
          status: Number,
          noLabel: {
            type: Boolean,
            value: false
          },
          noIcon: {
            type: Boolean,
            value: false
          },
          statusType: {
            type: String,
            computed: '_computeStatusType(status)',
            reflectToAttribute: true
          },
          label: {
            type: String,
            computed: '_computeLabel(status)',
          },
          icon: {
            type: String,
            computed: '_computeIcon(statusType)'
          }
        };
      }

      _computeStatusType(status) {
        switch (status) {
          case 1:
          case 'Sub':
          case 'OnT':
          case 'Com':
          case 'Acc':
            return 'success';
          case 2:
          case 'Ove':
          case 'Sen':
          case 'NoP':
          case 'Rej':
            return 'error';
          case 3:
          case 'Met':
          case 'Due':
          case 'Ong':
            return 'neutral';
          case 'Con':
          case 'Pla':
            return 'warning';
          case 'NoS':
          case null:
            return 'no-status';
        }
      }

      _computeLabel(status) {
        // TODO: refactor status label get method to use redux store statuses
        switch (status) {
          case 1:
            return 'Nothing due';
          case 2:
          case 'Ove':
            return 'Overdue';
          case 3:
          case 'Due':
            return 'Due';
          case 'Sub':
            return 'Submitted';
          case 'Rej':
            return 'Rejected';
          case 'Met':
            return 'Met';
          case 'OnT':
            return 'On Track';
          case 'NoP':
            return 'No Progress';
          case 'Con':
            return 'Constrained';
          case 'Ong':
            return 'Ongoing';
          case 'Pla':
            return 'Planned';
          case 'Com':
            return 'Completed';
          case 'Sen':
            return 'Sent Back';
          case 'Acc':
            return 'Accepted';
          case 'NoS':
          case null:
            return 'No Status';
        }
      }

      _computeIcon(type) {
        if (!this.hideIcon) {
          switch (type) {
            case 'success':
              return 'icons:check-circle';
            case 'error':
            case 'warning':
              return 'icons:error';
          }
        }
        return 'image:lens';
      }
    }

    window.customElements.define(ReportStatus.is, ReportStatus);
  </script>
</dom-module>

<link rel="import" href="../../../../../../../layout/components/etools-tabs.html">
<script>
  'use strict';

  window.EtoolsPmpApp = window.EtoolsPmpApp || {};
  window.EtoolsPmpApp.Mixins = window.EtoolsPmpApp.Mixins || {};

  /**
   * @polymer
   * @mixinFunction
   */
  EtoolsPmpApp.Mixins.IndicatorDialogTabs = Polymer.dedupingMixin(
      superClass => class extends superClass {

        static get properties() {
          return {
            indicatorDataTabs: {
              type: Array,
              value: [
                {
                  tab: 'details',
                  tabLabel: 'Details'
                },
                {
                  tab: 'disaggregations',
                  tabLabel: 'Disaggregations',
                  showTabCounter: true,
                  counter: 0
                }
              ]
            },
            activeTab: {
              type: String,
              value: 'details'
            }
          };
        }

        static get observers() {
          return [
            '_setDisaggregationsCount1(disaggregations, prpDisaggregations, isCluster)',
            '_setDisaggregationsCount2(disaggregations.length, prpDisaggregations.length)'
          ];
        }

        /**
         * Update disaggegations tab counter
         */
        _updateDisaggregationsNrInTabLabel(disaggregationsCount) {
          return this.set(['indicatorDataTabs', 1, 'counter'], disaggregationsCount);
        }

        _setDisaggregationsCount1(disaggregs, prpDisaggregs) {
          if (!this.indicator || !disaggregs || !prpDisaggregs) {
            this._updateDisaggregationsNrInTabLabel(0);
            return;
          }
          this._setDisaggregationsCount2(disaggregs.length, prpDisaggregs.length);
        }

        _setDisaggregationsCount2(disaggregsLength, prpDisaggregsLength) {
          if (typeof disaggregsLength === 'undefined' || typeof prpDisaggregsLength === 'undefined') {
            return;
          }
          let disaggregationsNr = this.isCluster ? prpDisaggregsLength : disaggregsLength;
          this._updateDisaggregationsNrInTabLabel(disaggregationsNr);
        }

        updateActiveTab(tab) {
          this.set('activeTab', tab);
        }

      });

</script>

<link rel="import" href="../../../bower_components/etools-behaviors/etools-logs-mixin.html">
<script>
  'use strict';

  window.EtoolsPmpApp = window.EtoolsPmpApp || {};
  window.EtoolsPmpApp.Mixins = window.EtoolsPmpApp.Mixins || {};
  /**
   * @polymer
   * @mixinFunction
   * @appliesMixin EtoolsLogsMixin
   */
  EtoolsPmpApp.Mixins.IE11 = baseClass => class extends EtoolsLogsMixin(baseClass) {

    static get properties() {
      return {
        isIE: Boolean
      };
    }

    checkIE11Browser() {
      this.isIE = this.isIEBrowser();
      window.isIE = this.isIE;
    }

    addIE11StyleTweaks() {
      if (this.isIE) {
        this.addIEBrowserStylesAdjustments();
      }
    }

    isIEBrowser() {
      let userAgent = window.navigator.userAgent;
      let ieBrowser = false;
      if (userAgent.indexOf('Trident/') > -1) {
        // IE 11
        ieBrowser = true;
      }
      return ieBrowser;
    }

    /**
     * In IE11 we must NOT use fullbleed and hasScrollingRegion and we have to make some
     */
    addIEBrowserStylesAdjustments() {
      this.classList.add('ie');
      let appHeaderLayout = this.$.appHeadLayout;
      appHeaderLayout.removeAttribute('fullbleed');
      appHeaderLayout.set('hasScrollingRegion', false);
      appHeaderLayout.style.height = '100%';
      let contentContainer = appHeaderLayout.shadowRoot.querySelector('#contentContainer');
      if (!contentContainer) {
        this.logWarn('contentContainer not found !!!', 'ie11-mixin');
      }
      if (contentContainer) {
        contentContainer.style.minHeight = '100vh';
        contentContainer.style.boxSizing = 'border-box';
        contentContainer.style.paddingBottom = '90px';
      }
      if (this.globalLoadingElement) {
        this.globalLoadingElement.style.position = 'fixed';
      }
    }

  };
</script>

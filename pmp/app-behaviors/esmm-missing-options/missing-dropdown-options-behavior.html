<link rel="import" href="../../../bower_components/etools-behaviors/etools-logs-behavior.html">
<link rel="import" href="../../app-config/app-endpoints-behavior.html">
<script>
  window.EtoolsPmpApp = window.EtoolsPmpApp || {};
  window.EtoolsPmpApp.Behaviors = window.EtoolsPmpApp.Behaviors || {};
  /** @polymerBehavior EtoolsPmpApp.Behaviors.MissingDropdownOptionsImpl */
  EtoolsPmpApp.Behaviors.MissingDropdownOptionsImpl = {

    setDropdownMissingOptionsAjaxDetails: function(dropdownEl, endpointName, params) {
      try {
        if (dropdownEl) {
          let endpointUrl = this.getMissingOptionsEndpointUrl(endpointName);
          params = (params) ? params : {};

          dropdownEl.set('ajaxParams', params);
          dropdownEl.set('url', endpointUrl);
        } else {
          this.logWarn('Esmm element is null and the endpoint ' + endpointName + ' url can not be assigned to it!',
              'missing-options-behavior');
        }
      } catch (err) {
        this.logError('An error occurred at ghost data esmm setup.', 'missing-options-behavior', err);
      }
    },

    getMissingOptionsEndpointUrl: function(endpointName) {
      let endpoint = this.getEndpoint(endpointName);
      if (endpoint && endpoint.url) {
        return endpoint.url;
      }
      return null;
    },

    getCleanEsmmOptions: function(options) {
      return (options instanceof Array) ? options.slice(0) : [];
    }

  };

  /** @polymerBehavior EtoolsPmpApp.Behaviors.MissingDropdownOptions */
  EtoolsPmpApp.Behaviors.MissingDropdownOptions = [
    EtoolsLogsBehavior,
    EtoolsPmpApp.Behaviors.Endpoints,
    EtoolsPmpApp.Behaviors.MissingDropdownOptionsImpl
  ];
</script>
